/*!
 * VERSION: 1.1.0
 * DATE: 2017-11-28
 *
 * @license Copyright (c) 2017, Priya Malhotra, pmalhotra.com . All rights reserved.
 *
 * @author: Priya Malhotra, contact@pmalhotra.com ; Vimal Patra, connect@vimalpatra.com
 */
(function(){"use strict";var currentSlideNumber,prevSlideNumber,slideTotalAnimationTime=1000,waitTimeBetweenRequestingPens=2000,waitTimeForGridItemLoaderSwapOut=3000,animTimeForGridItemLoaderSwapOut=500/1000,totalTimeForIntroCssAnims=1500,loadingInitalized=!1,filterDefault='*',filterChanged=!1,timeOutForLoading=slideTotalAnimationTime;var body,gsap,typingAnimation,typingAnimationLetters,fadeInUpAnimation,workPage,workGrid,workGridItem,workFilters,workFilterButtons,codepen__wrappers,codepenLength,skillsPage,skillTiles,moreSkills,moreSkillsContainer,closeMoreSkillsBtn,moreSkillTiles,hirePage,contactForm,cSubmit,fadeInLeftAnimation,fadeInUpAfterTyping,heart,fadeInUpBeforeTyping,sidebarAnimations,fadeInDownSidebar,fadeInUpSidebar,footerAnimations,fadeInUpFooter,footerName,allAnimationsHappening=[],codepensHtml=[],popup,popupTitle,popupText,loader;var htmlForWorkGridLoader=$('#gridItemLoaderTemplate').html();grabElements();removeCodepens();workSortAndFilter();splitTextUpforTyping();doCommonThings(!0);$(window).on('load hashchange',function(e){if(e.type=='load'){loadHandler()}else if(e.type=="hashchange"){hashChangeHandler()}});moreSkills.click(moreSkillsClickHandler);window.__CodePenIFrameAddedToPage=function(){if(!filterChanged){workGrid.isotope({filter:filterDefault})}};function loadHandler(){$(window).trigger("windowLoaded");setTimeout(function(){addBackCodepens()},500)}
function hashChangeHandler(){doCommonThings()}
function doCommonThings(runningOnLoad){setTweens(runningOnLoad);workForEachSlideAnims(runningOnLoad)}
var moreSkillsOpened=!1;function moreSkillsClickHandler(){if(!moreSkillsOpened){console.log('open');moreSkillsOpened=!0;openMoreSkills();closeMoreSkillsBtn.click(closeMoreSkills)}else{console.log('close');moreSkillsOpened=!1;closeMoreSkills()}}
function openMoreSkills(){var tlMax=new TimelineMax();tlMax.to(moreSkillsContainer,.3,{autoAlpha:1,rotationX:0}).staggerTo(moreSkillTiles,.2,{autoAlpha:1,y:0,ease:Back.easeOut.config(3)},.1)}
function closeMoreSkills(){var tlMax=new TimelineMax();tlMax.to(moreSkillsContainer,.25,{autoAlpha:0,rotationX:50}).set(moreSkillTiles,{autoAlpha:0,y:30})}
var parsley=contactForm.parsley().on('field:validated',function(){var errors=$('.parsley-error').length!=0;$('#contactForm').toggleClass('errors',errors);$('#invalidContactForm').toggleClass('vanish',!errors)}).on('form:submit',function(){var c_name=$('#c-name').val();var c_mail=$('#c-mail').val();var c_purpose=$('#c-purpose').val();var c_msg=$('#c-msg').val();$.post("form.php",{name:c_name,mail:c_mail,purpose:c_purpose,msg:c_msg},function(data){popupTitle.text('Success');popupTitle.addClass('success');popupText.html('Thanks for sending me the query. <br> I will get back as quickly as possible!');var tl=new TimelineLite();tl.to(popup,.5,{y:0,display:'block',autoAlpha:1}).to(popup,1,{y:20,autoAlpha:0},'+=3').set(popup,{display:'none'});contactForm[0].reset()});return!1});function grabElements(){body=$('#body');loader=$('#loader');workPage=body.find(".page.work");workGrid=workPage.find(".work__grid");workGridItem=workGrid.find('.grid-item > .wrapper');workFilters=workPage.find(".filters");workFilterButtons=workFilters.find('.button');codepen__wrappers=workGrid.find(".codepen__wrapper");skillsPage=body.find(".page.skills");skillTiles=skillsPage.find(".skillsContainer > .skill");moreSkills=skillsPage.find('.moreSkills');moreSkillsContainer=skillsPage.find('.moreSkillsContainer');moreSkillTiles=moreSkillsContainer.find('.skill');closeMoreSkillsBtn=moreSkillsContainer.find('.close');hirePage=body.find('.page.hire');contactForm=$('#contactForm');cSubmit=$('#c-submit');gsap=body.find(".gsap");fadeInUpAnimation=gsap.filter(".fadeInUpAnimation");typingAnimation=gsap.filter(".typingAnimation");fadeInLeftAnimation=gsap.filter(".fadeInLeftAnimation");fadeInUpAfterTyping=gsap.filter(".fadeInUpAfterTyping");heart=fadeInUpAfterTyping.filter(".heart");fadeInUpBeforeTyping=gsap.filter(".fadeInUpBeforeTyping");sidebarAnimations=gsap.filter(".sidebarAnimations");fadeInDownSidebar=sidebarAnimations.filter(".fadeInDownSidebar");fadeInUpSidebar=sidebarAnimations.filter(".fadeInUpSidebar");footerAnimations=gsap.filter(".footerAnimations");fadeInUpFooter=footerAnimations.filter(".fadeInUpFooter");footerName=$("footer").find(".name");popup=$('#popup');popupTitle=popup.find('.title');popupText=popup.find('moreText')}
function splitTextUpforTyping(){typingAnimation.each(function(i,el){var elem=$(el);var mySplitText=new SplitText(elem,{type:"chars,words"});$(mySplitText.chars).addClass('letters')});typingAnimationLetters=typingAnimation.find(".letters")}
function setTweens(runningOnLoad){TweenLite.set(fadeInUpAnimation,{autoAlpha:0,y:20});TweenLite.set(fadeInLeftAnimation,{autoAlpha:0,x:-50});TweenLite.set(codepen__wrappers,{autoAlpha:0,scale:0.7});TweenLite.set(skillTiles,{autoAlpha:0,rotationX:-70,perspective:500});TweenLite.set(typingAnimationLetters,{"display":"inline-block",autoAlpha:0,x:40});TweenLite.set(fadeInUpAfterTyping,{autoAlpha:0,scale:.1,y:15,});TweenLite.set(heart,{className:"-=pound"});if(runningOnLoad){TweenLite.set(body,{perspective:500});TweenLite.set(fadeInUpBeforeTyping,{autoAlpha:0,scale:.4,});TweenLite.set(fadeInDownSidebar,{y:-50,autoAlpha:0});TweenLite.set(fadeInUpFooter,{y:20,autoAlpha:0});TweenLite.set(moreSkillsContainer,{autoAlpha:0,rotationX:50,transformOrigin:"50% 0%"});TweenLite.set(moreSkillTiles,{autoAlpha:0,y:30});TweenLite.set(popup,{autoAlpha:0,display:"none",y:20})}}
function workForEachSlideAnims(runningOnLoad){currentSlideNumber=detectTheSlideNumber();if(!prevSlideNumber||prevSlideNumber!=currentSlideNumber){if(allAnimationsHappening.length){$.each(allAnimationsHappening,function(i,element){console.log(element);if(element.kill){console.log('kill method available');element.kill()}else if(element.killAll){console.log('killAll method available');element.killAll()}else{console.log('no methods available')}});allAnimationsHappening=[]}
prevSlideNumber=currentSlideNumber;var currentSlide=$("#p"+currentSlideNumber);if(runningOnLoad){$(window).on("windowLoaded",function(){if(!loadingInitalized){loadingInitalized=!0;console.log("windowLoaded");if(currentSlideNumber==1){timeOutForLoading=0}
setTimeout(function(){var tl=new TimelineLite({onComplete:loaderFadedOut});tl.to(loader,.5,{autoAlpha:0,ease:Power2.easeOut}).set(currentSlide,{className:"+=loaded"},'-=.5');function loaderFadedOut(){runAnimsForSlide(currentSlide,currentSlideNumber,runningOnLoad)}},timeOutForLoading)}})}
else{var newSlideTotalAnimationTime=slideTotalAnimationTime;if(currentSlideNumber==1){newSlideTotalAnimationTime=slideTotalAnimationTime/2}
setTimeout(function(){runAnimsForSlide(currentSlide,currentSlideNumber)},newSlideTotalAnimationTime)}}else{console.log("------ same slide ------")}}
function runAnimsForSlide(currentSlideElement,slideNumber,runningOnLoad){if(!currentSlideElement.length||!slideNumber){alert('runAnimsForSlide called without a Slide DOM Element or a slide number, contact the developer for this issue and report the same');return}
var $slide=currentSlideElement;var content=$slide.find(".content");content.focus();if(runningOnLoad){var tlsidebar=new TimelineLite();tlsidebar.staggerTo(fadeInDownSidebar,1,{autoAlpha:1,y:0,ease:Back.easeOut.config(3)},.2).set(footerName,{className:"+=signature"}).staggerTo(fadeInUpFooter,.5,{y:0,autoAlpha:1,ease:Power4.easeOut},.15,"+=1");/* will not kill these tweens as these are for footer*/}
if(slideNumber>0&&slideNumber<7){var gsap=$slide.find(".gsap");var fadeInUpAnimation=gsap.filter(".fadeInUpAnimation");var fadeInLeftAnimation=gsap.filter(".fadeInLeftAnimation");if(slideNumber==2){var tMaxSkills=TweenMax.staggerTo(skillTiles,1.5,{autoAlpha:1,rotationX:0,ease:Back.easeOut.config(3)},.2);allAnimationsHappening.push(tMaxSkills)}
if(slideNumber==3){if(fadeInUpAnimation.length){var tmFadeInUpAndWork=new TimelineLite();tmFadeInUpAndWork.staggerTo(fadeInUpAnimation,.3,{autoAlpha:1,y:0},.15).staggerTo(codepen__wrappers,.6,{autoAlpha:1,scale:1,ease:Back.easeOut.config(2)},.2);allAnimationsHappening.push(tmFadeInUpAndWork)}else{var tmaxWorkTiles=TweenMax.staggerTo(codepen__wrappers,.6,{autoAlpha:1,scale:1,ease:Back.easeOut.config(2)},.2);allAnimationsHappening.push(tmaxWorkTiles)}}
var typingAnimation=gsap.filter(".typingAnimation");if(typingAnimation.length){var tmTyping;if(slideNumber==1&&runningOnLoad){tmTyping=new TimelineMax({delay:(totalTimeForIntroCssAnims/1000)})}
else{tmTyping=new TimelineMax({delay:0})}
tmTyping.staggerTo(fadeInUpBeforeTyping,1.2,{autoAlpha:1,scale:1,ease:Elastic.easeOut.config(2)},.2).staggerTo(typingAnimationLetters,.03,{autoAlpha:1,x:0,y:0,ease:Back.easeOut.config(4)},.05,"-=.5").staggerTo(fadeInUpAfterTyping,.7,{autoAlpha:1,scale:1,y:0,ease:Back.easeOut.config(2)},.5).set(heart,{className:"+=pound"},"-=.5");allAnimationsHappening.push(tmTyping)}
if(gsap.length){if(fadeInUpAnimation.length&&fadeInLeftAnimation.length){var tlFadeInUpDown=new TimelineLite();tlFadeInUpDown.staggerTo(fadeInUpAnimation,.7,{autoAlpha:1,y:0},.3).staggerTo(fadeInLeftAnimation,1,{autoAlpha:1,x:0},.5,"-=.5");allAnimationsHappening.push(tlFadeInUpDown)}else if(fadeInUpAnimation.length){var tmaxFadeInUpOnly=TweenMax.staggerTo(fadeInUpAnimation,.7,{autoAlpha:1,y:0},.3);allAnimationsHappening.push(tmaxFadeInUpOnly)}else if(fadeInLeftAnimation.length){var tmaxFadeInLeftOnly=TweenMax.staggerTo(fadeInLeftAnimation,1,{autoAlpha:1,x:0},.5);allAnimationsHappening.push(tmax)}}else{console.log("there are no gsap elements in the slide number: "+slideNumber)}}else{location.hash=""}}
function workSortAndFilter(){workGrid.isotope({itemSelector:'.grid-item',layoutMode:'fitRows'});workGrid.isotope({filter:filterDefault});workFilters.on('click','.button',function(){filterChanged=!0;var $this=$(this);var dataFilter=$this.data('filter');workFilterButtons.removeClass("active");$this.addClass("active");workGrid.isotope({filter:dataFilter})})}
function detectTheSlideNumber(){var slideNumber,hash,filterLinkNumberPattern;hash=location.hash;filterLinkNumberPattern=/^\#link\d+((?=\/)|(?![\S]))/g;if(filterLinkNumberPattern.test(hash)){return slideNumber=String(/\d{1,5}((?=\/)|(?![\S]))/.exec(hash)).replace(/[^0-9]/g,"")}else{return 1}}
function removeCodepens(){codepen__wrappers.each(function(i,elem){var $this=$(this);$this.remove();codepensHtml.push($this[0].outerHTML);workGridItem.eq(i).html(htmlForWorkGridLoader)});console.log('total number of pens in html are: '+codepensHtml.length)}
function addBackCodepens(){var indexedGridItems=[];workGridItem.each(function(i){indexedGridItems.push(this)});var i=0;requestAnimationFrame(addPen);function addPen(){var gridItemToUse=$(indexedGridItems[i]);if(!gridItemToUse.length){return}
setTimeout(function(){gridItemToUse.html(codepensHtml[i]+htmlForWorkGridLoader);setTimeout(function(){var gridItemLoader=gridItemToUse.find('.gridItemLoader');TweenLite.to(gridItemLoader,animTimeForGridItemLoaderSwapOut,{autoAlpha:0,y:"-80%"})},waitTimeForGridItemLoaderSwapOut);i++;requestAnimationFrame(addPen)},waitTimeBetweenRequestingPens)}}/* /addBackCodepens */}());/* iife/siaf closure ends*/